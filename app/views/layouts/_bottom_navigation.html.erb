<nav class="md:hidden fixed bottom-0 left-0 right-0 bg-background z-50 hidden standalone:block">
  <div class="flex items-center justify-around py-2 px-4 safe-area-pb">
    <% if Current.user %>
      <%= link_to habits_path, class: "flex flex-col items-center justify-center p-2 rounded-lg transition-colors #{current_page?(habits_path) ? 'text-primary' : 'text-muted-foreground hover:text-primary'}" do %>
        <%= lucide_icon('list', class: 'w-5 h-5 mb-1') %>
        <span class="text-xs font-medium">Habits</span>
      <% end %>
      <%= link_to new_habit_path, class: "flex flex-col items-center justify-center p-2 rounded-lg transition-colors #{current_page?(new_habit_path) ? 'text-primary' : 'text-muted-foreground hover:text-primary'}" do %>
        <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center text-primary-foreground mb-1">
          <%= lucide_icon('plus', class: 'w-4 h-4') %>
        </div>
        <span class="text-xs font-medium text-primary">Add</span>
      <% end %>
      <%= link_to user_path(id: Current.user.id), class: "flex flex-col items-center justify-center p-2 rounded-lg transition-colors #{current_page?(user_path(id: Current.user.id)) ? 'text-primary' : 'text-muted-foreground hover:text-primary'}" do %>
        <div class="w-6 h-6 rounded-full overflow-hidden bg-primary-foreground flex items-center justify-center mb-1 border-2 #{current_page?(user_path(id: Current.user.id)) ? 'border-primary' : 'border-transparent'}">
          <% if Current.user.avatar.attached? %>
            <%= image_tag Current.user.avatar, class: "object-cover h-full w-full" %>
          <% else %>
            <div class="h-full w-full rounded-full bg-stone-200 flex items-center justify-center text-stone-500 text-xs font-semibold">
              <%= Current.user.first_name.first.upcase if Current.user.first_name.present? %>
            </div>
          <% end %>
        </div>
        <span class="text-xs font-medium">Profile</span>
      <% end %>
    <% end %>
  </div>
</nav>

<!-- Add bottom padding to body content to prevent overlap -->
<style>
  @media (display-mode: standalone) {
    @media (max-width: 767px) {
      body {
        padding-bottom: 80px;
      }
    }
  }
</style>